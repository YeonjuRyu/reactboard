<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Write something else you want</title>
<script scr="./jquery-3.4.1.min.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
 <!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="./functions.js"></script> <!--api post get functions-->
<link rel="stylesheet" type="text/css" href="mainstyle.css">
<script type="text/javascript" src="http://jsgetip.appspot.com"></script> <!--IP가져오기용-->
</head>
<body>
    <div class="topnav">
        <a href="main.html">React Board</a>
        <b href="#">로그인</b>
        <b href="#">사진</b>
        <b href="#">소개</b>
        <b href="#">게시판</b>
    </div>
    
    <div class="row">
        <div class="column left">
            <h1>게시판</h1>
                <div id="board_name" class = "table_style_left">
          </div>
     </div>
     
    <div class="column middle">
        <table class="table table-bordered">
    <thead>
        <caption> 글쓰기 </caption>
    </thead>
    <tbody>
        <form action="write_ok.jsp" method="post" encType="multiplart/form-data">
            <tr>
                <th>제목: </th>
                <td><input type="text" placeholder="제목을 입력하세요. " id="post_title" class="form-control"/></td>
            </tr>
            <tr>
                <th>내용: </th>
                <td><textarea cols="10" placeholder="내용을 입력하세요. " id="post_content" class="form-control"></textarea></td>
            </tr>
            <tr>
                <td colspan="2">
                    <input type="button" value="등록" onclick="writingpost(infoData)" class="pull-right"/>
                </td>
            </tr>
        </form>
    </tbody>
</table>
</div>
</div>
<div class="footer">
        <p> Copyright ⓒ Your Website 2019 </p>
      </div>
<script>
    //~~~ function, to bring board 
      var boardList = document.getElementById("board_name")
      //api에 있는 board list의 개수를  -> for문을 돌려서 가져온 후, 그만큼 카테고리 생성
      var ul = document.createElement('ul');
      getboardlist( _boardList => {
        for(var i=0; i<_boardList.length; i++) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.innerHTML = _boardList[i].board_name;
          a.id = _boardList[i].id;
          a.href = "boardlist.html?id="+_boardList[i].id;
          li.appendChild(a)
          ul.appendChild(li);
        }
        //ul.appendChild(li); //ul 아래에 li을 넣어줌 
        boardList.appendChild(ul); 
      });
      
          //1.필요한 모든 정보를 생성한다.
          //1-1. post id
          var id = 9;
          //1-2. board id
          var params = new URLSearchParams(document.location.search.substring(1));
          var board_id = params.get("id")
          //1-3. post_title
          var post_title = document.getElementById("post_title");
          //1-4. post_content
          var post_content = document.getElementById("post_content");
          //1-5. post_reg_date (자동생성)
          var post_reg_date = getTimeStamp();
          //1-6. post_user_name (default)
          var post_user_name = "Unknown";
          //1-7. post_reg_ip (자동생성)
          var post_reg_ip =  ip();
          //2. 정보를 Array에 담는다
          var infoData = [id, board_id, post_title, post_content, post_reg_date, post_user_name, post_reg_ip];

      function leadingZeros(n, digits) {
          var zero = '';
          n = n.toString();
          if (n.length < digits) {
              for (i = 0; i < digits - n.length; i++)
              zero += '0';
            }
            return zero + n;
        }


      function getTimeStamp() {
          var d = new Date();
          var ampm;
          if (leadingZeros(d.getHours(), 2) < 13){
              ampm="AM";
          }
          else {ampm ="PM"};
          var s = leadingZeros(d.getFullYear(), 4) + '-' + leadingZeros(d.getMonth() + 1, 2)
          + '-' + leadingZeros(d.getDate(), 2) + ' ' +leadingZeros(d.getHours(), 2)
          + ':' +leadingZeros(d.getMinutes(), 2) + ':' + leadingZeros(d.getSeconds(), 2) + ' ' +ampm;
          return s;
}
</script>
</body>
</html>
